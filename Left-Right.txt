///===========================================
// a[i] = min(a[l[i]],...,a[r[i]])
for (int i = 1; i <= n; i++)
    {
        l[i] = i - 1;
        while ( a[i] <= a[l[i]] ) l[i] = l[l[i]];
    }
    for (int i = n; i >= 1; i--)
    {
        r[i] = i + 1;
        while ( a[i] <= a[r[i]] ) r[i] = r[r[i]];
    }
///===========================================